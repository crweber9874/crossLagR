[["panel-data-models.html", "Chapter 1 Panel Data Models 1.1 The Cross-Lagged Panel Model 1.2 The Change Score Regression 1.3 Algebraic Equivalence 1.4 Decomposing Change 1.5 Bivariate Dual Change 1.6 The Random Intercept Cross Lagged Regression 1.7 Spurious and Causal Effects 1.8 Confounding Variables", " Chapter 1 Panel Data Models Social scientists often turn to panel data to diagnose causal effects when experiments are impractical . Whereas dozens of options exist for analyzing longer time series, researchers wishing to analyze cross-sectionally dominant panel structures – in which there are more units than time points – face a more limited set of choices. National surveys like found in the American National Election Studies (ANES) may consist of just a handful of waves, with many respondents interviewed only once or twice. 1.1 The Cross-Lagged Panel Model In such cases, researchers have tended to rely upon the cross-lagged panel model (CLPM). The CLPM is appealing for its intuitiveness, flexibility, and ease of implementation. The cross-lagged regression model follows an intuitive structure. The current realizations \\(x\\) and \\(y\\) are a function of autoregressive and cross lagged effects. As such, the autoregression term(s) capture time dependence, while the cross-lagged terms capture how another variable leads to change in the outcome variable. Depending on the researcher’s preferences, a CLPM can be as complicated as estimating a series of simultaneous equations with latent variables or as simple as adding lagged variables to an ordinary least squares regression. Yet, given the CLPM’s popularity, there has been a surprising lack of discussion in political science about its statistical properties, especially in comparison to other alternative methods. In fact, in the decade since (Hamaker, Kuiper, and Grasman 2015) published an influential critique of the CLPM, the number of published political science articles using the method has more than doubled (from 74 to 169). \\[ \\begin{matrix} y_{it} &amp; = \\alpha_{y} + \\beta_{1}y_{it-1} + \\theta_x x_{it-1} + e_{y,it}\\\\ x_{it} &amp; = \\alpha_{x} + \\beta_{1}x_{it-1} + \\theta_x y_{it-1}+ e_{x,it}\\\\ \\end{matrix} \\] We closely follow the structure that \\(\\alpha\\) correspond to intercepts, which eventually may vary across units. It is also common to write the CLPM with mean centered variables, in which case the intercept is 0. The \\(\\beta\\) parameters are autoregressive effects. And the \\(\\theta\\) parameters are cross-lagged effects. The error terms \\(e_{y,it}\\) and \\(e_{x,it}\\) are assumed to be normally distributed with mean zero and constant variance, and uncorrelated with each other. In practice, they are often correlated, such that \\(cov(e^y_{t,i}, e^x_{t,i}) \\neq 0\\). Figure 1.1: Cross-Lagged Panel Model It’s advantageous to write the CLPM in terms of latent variables – p and q – for the simple reason that this formulation can easily be extended to models with measurement error, varying factor structures, and multiple indicators per construct. In this formulation, the \\(y = p\\) and \\(x = q\\). However, the model below constructs latent variables for each time point, with factor loadings, \\(\\lambda\\). The model accounts for measurement error. Each indicator is defined by the latent variable, and an error term (the dashed loops). Figure 1.2: Cross-Lagged Panel Model, Multiple Indicators In addition, insofar as the constructs measured at each time point are modeled as latent variables, the CLPM can be extended to account for correlated errors, factor invariance, and multiple group comparisons. Below we generally write the CLPM in terms of single indicator variables, though these models can all easily account for multiple indicators. 1.2 The Change Score Regression Panel structures are useful to uncover dynamic relationships in data, in that the researcher may leverage over-time relationships to examine the characteristics of changes, and the relationships of change processes with other covariates (Allison 1990). One popular approach to modeling change is the change score regression model. The change score regression model focuses on the difference between time \\(t\\) and time \\(t-1\\) for each variable. Defining the change scores as \\(\\Delta y_{it}\\) and \\(\\Delta x_{it}\\), we can rewrite the CLPM in terms of change scores. \\[ \\Delta y_{it} = y_{it} - y_{it-1}\\\\ \\Delta x_{it} = x_{it} - x_{it-1} \\] Where the regression model is a model of change, expressed as differences rather than in level form. \\[ \\begin{matrix} \\Delta y_{it} &amp; = \\alpha_{y} + \\beta_{y}y_{it-1} + \\theta_x x_{it-1} + e_{y,it}\\\\ \\Delta x_{it} &amp; = \\alpha_{x} + \\beta_{x}x_{it-1} + \\theta_x y_{it-1}+ e_{x,it}\\\\ \\end{matrix} \\] The \\(\\beta\\) parameter here correspond to a proportional effect. How much does a the prior value of \\(y\\) influence the change from time \\(t-1\\) to time \\(t\\)? The \\(\\beta\\) parameter is equivalent in the CLPM – the autoregressive parameter – is equivalent to \\(\\beta\\) here. 1.3 Algebraic Equivalence Expressed in this way, the change score model and the CLPM are algebraically equal. Consider \\(y_{it}\\) and \\(\\Delta y_{it}\\): \\[ \\begin{matrix} \\text{The CLPM: } &amp;y_{it} = \\beta_{y}y_{t-1} + \\theta_{1y} x_{t-1} + e_{y,it}\\\\ \\text{Subtract } y_{it-1}: &amp;y_{it} - y_{it-1} = \\beta_{y}y_{t-1} + \\theta_{1y} x_{t-1} + e_{y,it} - y_{it-1}\\\\ &amp; \\Delta y_{it} = (\\beta_{y} - 1) y_{t-1} + \\theta_{y} x_{t-1} + e_{y,it}\\\\ &amp; \\Delta y_{it} = \\tilde{\\beta}_y y_{t-1} + \\theta_{y} x_{t-1} + e_{y,it}\\\\ \\text{Where: } &amp;\\tilde{\\beta}_y = \\beta_{x} - 1 \\end{matrix} \\] The structure of the model remains unchanged. The models are interchangeable, and the lagged and cross-lagged effects simply become proportional and cross-proportional effects on change scores. # Simulate a five wave panel, with two variables, x y: simCLPM(waves = 5)$data |&gt; # In crossLagR there is a helper function to transform wide to long reshape_long_sim_cr() |&gt; # Id identifies the subject, so use this to construct lags group_by(id) |&gt; mutate( y_lag = lag(y), x_lag = lag(x), # Change Score delta_y = y - lag(y) ) |&gt; ungroup() -&gt; data head(data) ## # A tibble: 6 × 13 ## id wave x y xlag xlagw ylag ylagw within.x within.y ## &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; ## 1 1 1 -1.06 0.412 NA NA NA NA -1.35 0.360 ## 2 1 2 -0.0626 1.29 -1.06 -1.35 0.412 0.360 -0.354 1.23 ## 3 1 3 0.676 -0.579 -0.0626 -0.354 1.29 1.23 0.385 -0.631 ## 4 1 4 0.668 -0.940 0.676 0.385 -0.579 -0.631 0.376 -0.992 ## 5 1 5 1.23 0.0795 0.668 0.376 -0.940 -0.992 0.940 0.0275 ## 6 2 1 0.529 2.08 NA NA NA NA 0.414 1.67 ## # ℹ 3 more variables: y_lag &lt;dbl&gt;, x_lag &lt;dbl&gt;, delta_y &lt;dbl&gt; ## ## Call: ## lm(formula = delta_y ~ y_lag + x_lag, data = data) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.5822 -0.6563 0.0090 0.6639 4.5327 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.02723 0.02202 -1.236 0.217 ## y_lag -0.81301 0.02253 -36.078 &lt; 2e-16 *** ## x_lag 0.10166 0.02135 4.762 2.06e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.9847 on 1997 degrees of freedom ## (500 observations deleted due to missingness) ## Multiple R-squared: 0.3949, Adjusted R-squared: 0.3943 ## F-statistic: 651.6 on 2 and 1997 DF, p-value: &lt; 2.2e-16 ## ## Call: ## lm(formula = y ~ y_lag + x_lag, data = data) ## ## Residuals: ## Min 1Q Median 3Q Max ## -3.5822 -0.6563 0.0090 0.6639 4.5327 ## ## Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.02723 0.02202 -1.236 0.217 ## y_lag 0.18699 0.02253 8.298 &lt; 2e-16 *** ## x_lag 0.10166 0.02135 4.762 2.06e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## Residual standard error: 0.9847 on 1997 degrees of freedom ## (500 observations deleted due to missingness) ## Multiple R-squared: 0.0511, Adjusted R-squared: 0.05015 ## F-statistic: 53.77 on 2 and 1997 DF, p-value: &lt; 2.2e-16 The cross-lagged parameters are equal, the AR parameters by \\(1-\\beta\\). In the change score model, when \\(\\beta &gt; 1\\), then increases in \\(y\\) at time \\(t-1\\) are associated with increases in \\(y\\) at time \\(t\\), what is called “explosive growth.” When \\(\\beta &lt; 1\\), increases in \\(y\\) at time \\(t-1\\) are associated with proportional change in \\(y\\) at time \\(t\\). The trajectory will decay toward the mean, displaying “regression to the mean.” When \\(\\beta = 0\\) (and \\(\\theta=0\\)), there is no association between \\(y\\) at time \\(t-1\\) and \\(y\\) at time \\(t\\) and the model displays a random walk process. While not the conventional approach to panel data analysis in the social sciences, the change score method affords greater leverage in understanding the dynamics of a change process. In addition to the algebraic equivalence of the CLPM, extensions to the change score regression model, allow one to decompose change into constituent processes, proportional, constant, and dual change . 1.4 Decomposing Change The univariate change score regression model allows us to decompose change into three components: constant, proportional, and dual change processes (Grimm et al. 2012). \\[ \\begin{matrix} \\Delta y_{it} &amp; = \\alpha_{y} s_i + \\beta_{1}y_{it-1} + e_{y,it}\\\\ \\Delta x_{it} &amp; = \\alpha_{x} s_i + \\beta_{1}x_{it-1} + e_{x,it}\\\\ \\end{matrix} \\] The \\(\\alpha\\) parameters are the effects of a stable trait level component, \\(s_i\\), on the change scores. \\(s_i\\) is a “unit effect” – corresponding to an estimate of constant change for each row of the data. In a panel, individuals will score higher on this component, indicating they change more in their average change relative to others. The \\(\\alpha\\) captures the effect of \\(s_i\\) on the change score at a particular time point. The \\(beta\\) parameters are the proportional effect of \\(y\\) and \\(x\\) at time \\(t-1\\) on the change score at time \\(t\\). This parameter is the autoregressive parameter in the the CLPM. If \\(\\beta = 0\\), then \\(\\alpha\\) simply captures how a subject’s average change score influences change at time \\(t\\). Combining the two is the “dual-change” model. When \\(\\beta\\) is positive, higher values of \\(y\\) or \\(x\\) at time \\(t-1\\) are associated with increases in the variable at time \\(t\\). When \\(\\beta\\) is negative, higher values of \\(y\\) or \\(x\\) at time \\(t-1\\) are associated with decreases in the variable at time \\(t\\). When \\(\\beta\\) is zero, there is no association between prior values and change scores, and the model displays a random walk process. It’s useful to consider the trajectory of an individual’s changes across the length of a panel, or possibly a shorter interval. The trajectory\\(y\\) and \\(x\\) from time \\(t=1\\) to time \\(t=k\\). \\[ y_{i,k} = y_{i,t=1} + \\sum_{t=2}^{k} \\Delta y_{ik} \\\\ x_{i,k} = x_{i,t=1} + \\sum_{t=2}^{k} \\Delta x_{ik} \\\\ \\] 1.5 Bivariate Dual Change With cross-lagged effects, \\[ \\begin{matrix} \\Delta y_{it} &amp; = \\alpha_{y} s_i + \\beta_{1}y_{it-1} + \\theta_x x_{it} + e_{y,it}\\\\ \\Delta x_{it} &amp; = \\alpha_{x} s_i + \\beta_{1}x_{it-1} + \\theta_x y_{it}+ e_{x,it}\\\\ \\end{matrix} \\] Unlike the CLPM which captures only proportional change, the change score regression model captures constant, proportional, and dual change processes. 1.6 The Random Intercept Cross Lagged Regression The RICLPM – a popular approach in psychology – also explicitly includes trait level variation, but in a manner somewhat different from the difference score approaches described. For the moment, ignoring the lags and cross-lagged effects, let us assume that \\(x\\) and \\(y\\) are each a function of a stable trait level component, plus a time-varying state component. The RICLPM is an extension of the CLPM, \\[ \\begin{bmatrix} y_{it}\\\\ x_{it} \\end{bmatrix} = \\begin{bmatrix} \\theta_{1y} &amp; \\theta_{1x} \\\\ \\theta_{2y} &amp; \\theta_{2x} \\end{bmatrix} \\begin{bmatrix} y_{it-1} \\\\ x_{it-1} \\end{bmatrix} + \\begin{bmatrix} e_{y,it}\\\\ e_{x,it} \\end{bmatrix} \\] But the RICLPM includes a stable trait level component, \\(\\mu_i\\), for each individual \\(i\\): \\[ \\begin{bmatrix} y_{it}\\\\ x_{it} \\end{bmatrix} = \\begin{bmatrix} \\mu^y_{i} \\\\ \\mu^x_{i} \\end{bmatrix} + \\begin{bmatrix} y^*_{y,it}\\\\ x^*_{x,it} \\end{bmatrix} \\] The \\(\\mu^x_i\\) and \\(\\mu^y_i\\) terms are the stable, trait level components for individual \\(i\\). And \\(x^*_{t,i}\\) and \\(y^*_{t,i}\\) terms are the time-varying state components. We can view this formation as providing a decomposition of the total variance in \\(x\\) and \\(y\\) into between-person (trait; \\(\\mu\\)) and within-person (state, \\(x^*,y^*\\)) components. From here, we can rewrite the cross-lagged and lagged effects from the state components alone. \\[ \\begin{bmatrix} y^*_{it}\\\\ x^*_{it} \\end{bmatrix} = \\begin{bmatrix} \\theta^*_{1y} &amp; \\theta^*_{1x} \\\\ \\theta^*_{2y} &amp; \\theta^*_{2x} \\end{bmatrix} \\begin{bmatrix} y^*_{it-1} \\\\ x^*_{it-1} \\end{bmatrix} + \\begin{bmatrix} e^*_{y,it}\\\\ e^*_{x,it} \\end{bmatrix} \\] Unlike the CLPM, the RICLPM examines residualized change, or change net of stable trait level differences between individuals. The RICLPM thus focuses on within-person effects – \\(y^*_{it}\\) and \\(x^*_{it}\\) represent deviations from the individual’s mean score for \\(y\\) and \\(x\\). Figure 1.3: Random Intercept Cross-Lagged Panel Model with 5 waves. The model shows autoregressive paths (solid arrows), cross-lagged effects (solid arrows), within-time correlations (dashed curved arrows), and residual terms (self-loops). As shown in Figure 1.3, the RI-CLPM separates between-person and within-person effects. The next section builds on these two models, using synthetic data, to illustrate the similarities and similarities between these approaches. 1.7 Spurious and Causal Effects Particularly since (hamaker_cross-lagged_2015?) who showed that the CLPM conflates between-person and within-person effects, and may produce biased estimates of the cross-lagged effects, insofar that \\(x\\), \\(y\\) or both are stable, relatively enduring traits that don’t vary from wave-to-wave. This is conceptually similar to Lord’s Paradox. (allison_toward_2015?) elaborates on Lord’s Paradox in the context difference score models models. Using a similar description, imagine a two wave panel, in which subjects are assigned to the treatment or control following the pretest. For those assigned to the treatment, the pretest mean and standard deviation are nearly identical to the posttest mean and standard deviation. And, the correlation between \\(y\\) in both waves is less than 1. The description is entirely consist with observing no treatment effect; the means do not change from pretest to posttest for those exposed to the treatment. But, a variant of the CLPM, where when regresses the \\[y_{post} = \\alpha + \\beta \\cdot y_{pre} + \\gamma \\cdot treatment + \\epsilon\\] reports a different estimate of the treatment effect, as it compares the mean differences between those exposed to the treatment versus control condition, controlling for the pretest (baseline) score. This is different from examining the difference in scores among those exposed to the treatment. While Lord’s Paradox is not entirely ameliorated by using random assignment, the issue becomes more severe if the treatment is not randomly assigned, and one is simply comparing group mean differences. The issue is similarity to the CLPM in that one conflates between-person and within-person effects, by not accounting for unit effects (stable trait level differences between individuals), and one might conclude a cross-lag effect exists – e.g., x causes a change in y – when instead the \\(x\\) may be related to \\(y\\) but not necessarily cause a change in \\(y\\). Extending the model, we can use the CLPM and RI-CLPM to produce potential outcomes ; what would \\(x_{t,i}\\) and \\(y_{t,i}\\) be if we intervened on \\(x\\) or \\(y\\) at time \\(t-1\\), \\(E[x_{i,t}^{y_{t-1}}]\\) and \\(E[y_{i,t}^{x_{t-1}}]\\)? By assuming that such an intervention is linear, similar to the structure set forth in the CLPM, the marginal effect of the treatment is \\(\\tau\\) (Ludtke and Robitzch 2021; Hernan and Robins 2020; Vanderwheele 2015). \\[ \\begin{aligned} E[Y_{i,t}^{x_{t-1}}] = \\alpha_{1} + \\tau_{1} x_{t-1} \\\\ E[X_{i,t}^{y_{t-1}}] = \\alpha_{2} + \\tau_{2} y_{t-1} \\\\ \\end{aligned} \\] The marginal effects, \\(\\tau\\) are calculated by the expectations fixing \\(x_{t,i}\\) and \\(y_{t,i}\\) at a value and integrated over the joint distribution of \\(x_{t-1}\\) and \\(y_{t-1}\\). In a linear model, this is typically just \\(\\hat{\\theta_{1y}}\\) and \\(\\hat{\\theta_{2x}}\\), the slopes from a regression equation. If there are unobserved confounders, \\(Z\\), then \\[ \\begin{aligned} E[X_{i,t}^{y_{t-1}}] = \\tau_{1,1} = \\int E[X_{i,t} | X_{i, t-1} = x_{t-1}, Y = y_{i,t-1}, \\textbf{Z} = z] f(x_{t-1}, y_{t-1}, z) dx_{t-1}dy_{t-1}d_z \\\\ E[Y_{i,t}^{x_{t-1}}] = \\tau_{1,2} = \\int E[Y_{i,t} | X_{i, t-1} = x_{t-1}, Y = y_{i,t-1}, \\textbf{Z} = z] f(x_{t-1}, y_{t-1}, z) dx_{t-1}dy_{t-1}d_z\\\\ \\end{aligned} \\] The potential outcome is simply the expectation of \\(x_{t,i}\\) and \\(_{y,i}\\), holding \\(y_{t-1}\\) and \\(x_{t-1}\\) at a fixed value, and averaging over the joint distribution of \\(x_{t-1}\\), \\(y_{t-1}\\), and \\(z\\). 1.8 Confounding Variables In the presence of confounding variables, \\(Z\\), that influence both \\(x\\) and \\(y\\), the cross-lagged estimates may be biased, in both the CLPM or the RI-CLPM. A confounder, like all variables in a panel design may be time-varying or time-invariant. Some characteristics fluctuate over time, partially or fully explaining the pattern of relationships between \\(x\\) and \\(y\\), others are stable and tend not to change, but also explain the joint relationship between \\(x\\) and \\(y\\). If confounder \\(z\\) is time-invariant, the CLPM may be respecified as the RI-CLPM: \\[ \\begin{bmatrix} y^*_{it}\\\\ x^*_{it} \\end{bmatrix} = \\underbrace{ \\begin{bmatrix} \\theta^*_{1y} &amp; \\theta^*_{1x} \\\\ \\theta^*_{2y} &amp; \\theta^*_{2x} \\end{bmatrix} \\begin{bmatrix} y^*_{it-1} \\\\ x^*_{t-1} \\end{bmatrix} + \\begin{bmatrix} e^*_{y,it}\\\\ e^*_{x,it} \\end{bmatrix} }_{State} + \\underbrace{ \\begin{bmatrix} \\mu_{y,i}\\\\ \\mu_{x,i} \\end{bmatrix} + \\begin{bmatrix} \\alpha_{y}\\\\ \\alpha_{x} \\end{bmatrix} z_{i} }_{Trait} \\] \\(\\mu^x_i\\) and \\(\\mu^y_i\\) are the stable, trait level components for individual \\(i\\). \\(x^*_{t,i}\\) and \\(y^*_{t,i}\\) are the time-varying state components. \\(\\theta^*_{1y}\\) and \\(\\theta^*_{2x}\\) are the autoregressive effects for the state components. \\(\\theta^*_{1x}\\) and \\(\\theta^*_{1x}\\) are the cross-lagged effects for the state components. When the confounder is “unobserved” and either time-invariant or time-varying, what is the consequence of ignoring that confounder in the CLPM or RI-CLPM? There is some disagreement in the literature on this question. Allison, Paul D. 1990. “Change Scores as Dependent Variables in Regression Analysis.” Sociological Methodology, 93–114. Grimm, Kevin J, Yang An, John J McArdle, Alan B Zonderman, and Susan M Resnick. 2012. “Recent Changes Leading to Subsequent Changes: Extensions of Multivariate Latent Difference Score Models.” Structural Equation Modeling: A Multidisciplinary Journal 19 (2): 268–92. Hamaker, Ellen L., Rebecca M. Kuiper, and Raoul P. P. P. Grasman. 2015. “A Critique of the Cross-Lagged Panel Model.” Psychological Methods 20 (1): 102–16. https://doi.org/10.1037/a0038889. References Allison, Paul D. 1990. “Change Scores as Dependent Variables in Regression Analysis.” Sociological Methodology, 93–114. Grimm, Kevin J, Yang An, John J McArdle, Alan B Zonderman, and Susan M Resnick. 2012. “Recent Changes Leading to Subsequent Changes: Extensions of Multivariate Latent Difference Score Models.” Structural Equation Modeling: A Multidisciplinary Journal 19 (2): 268–92. Hamaker, Ellen L., Rebecca M. Kuiper, and Raoul P. P. P. Grasman. 2015. “A Critique of the Cross-Lagged Panel Model.” Psychological Methods 20 (1): 102–16. https://doi.org/10.1037/a0038889. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
